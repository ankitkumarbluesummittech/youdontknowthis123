<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script>
    // window.localStorage.setItem("token", 'dfdfgdfgfdgdf');
    // window.localStorage.removeItem('token');
  </script>
  <title>Document</title>
</head>

<body>
  <h1>Login</h1>
  <button onclick="onSignupButtonClick()">onSignupButtonClick</button>
  <script>
    if (window.top && window.top !== window.self) {
      window.postMessage("Hello Ankit", "*")
    }
    // Function to run when the signup button is clickedg
    function onSignupButtonClick() {
      // const token = localStorage.getItem("token");
      const name = "Ankit Jha";
      const logInfo = { hasToken: 1234, name };
      const message = logInfo;
      if (window.top && window.top !== window.self) {
        window.parent.postMessage(
          message,
          "https://youdontknowthisparent123.netlify.app"
        );
        // window.top.location.href = "https://youdontknowthis123.netlify.app"
       const isNewEvent=  window.document.dispatchEvent(new CustomEvent("messageSent", { detail: message }));
        console.log(isNewEvent, "Yes It's an new Event");
        
        window.document.addEventListener("messageSent", function (event) {
          console.log("Message sent:", event.detail);
          // Additional actions or logging can be performed here
        // window.top.location.href = "https://youdontknowthis123.netlify.app"
        });
      }
    }
    // window.onSignupButtonClick();
    const token = localStorage.getItem("token");
    console.log(token, "Token");
    const name = "Ankit";
    const logInfo = { hasToken: !!token, name };
    const message = logInfo;
    if (window.top && window.top !== window.self) {
      window.parent.postMessage(
        message,
        "https://youdontknowthisparent123.netlify.app"
      );
    }

    //   window.addEventListener("load", function() {
    //   const token = localStorage.getItem("token");
    //   const name = "Ankit";
    //   const logInfo = { hasToken: !!token, name };
    //   const message = logInfo;
    //   if (window.top && window.top !== window.self) {
    //       window.parent.postMessage(
    //         message,
    //         "https://youdontknowthisparent123.netlify.app"
    //       );
    //   }
    // });

    // Child iframe
    // window.addEventListener(
    //   "message",
    //   function (event) {
    //     if (event.data === "requestLocalStorage") {
    //       const token = localStorage.getItem("token");
    //       const name = "Ankit";
    //       const logInfo = { hasToken: !!token, name };
    //       event.source.postMessage(logInfo, event.origin);
    //     }
    //   },
    //   false
    // );
  </script>
</body>

</html>